### [:diamond_shape_with_a_dot_inside:](#toc) <a name='3'>useradd</a>

_**Задача:** Создать новую учетную запись пользователя с личной группой и домашний каталог с набором файлов по умолчанию, таких как `.bashrc`, `.profile`, `.bash_history`, и любыми другими необходимыми файлами._

В большинстве дистрибутивов Linux для этой цели имеется команда `useradd`, которую можно настроить под свои требования. Конфигурация по умолчанию различается в разных дистрибутивах, поэтому самый простой способ узнать используемые настройки — создать новую пробную учетную запись:

```ruby
# Создать пользователя
sudo useradd test1

# Проверяем созданного пользователя
id test1
sudo ls -a /home/test1/

# Устанавливаем пароль
sudo passwd test1

# Заставить пользователя сменить пароль при первом входе в систему
sudo passwd -e test1

# Создать пользователю домашний каталог (m) и добавить в личную группу (U)
sudo useradd -mU test2

# -G, --groups — добавляет пользователя в несколько дополнительных групп
sudo useradd -G group1,group2,group3 test1

# -c, --comment — принимает любую текстовую строку и сохраняет ее как полное имя пользователя, комментарий или описание
sudo useradd -G group1,group2,group3 -c 'Test 1,,,,' test1
```


```ruby
# Дополнительная информация
man 8 useradd
man 5 login.defs
/etc/default/useradd
/etc/skel
/etc/login/defs
```


<br>

_**Задача:** Создание системной учетной записи с помощью команды useradd._


Параметр `-r` создает системного пользователя с реальным UID из диапазона, предназначенного для системных пользователей, а параметр `-s` задает оболочку входа `/bin/false` — команду, которая ничего не делает и не позволяет выполнить вход в систему с именем этого пользователя.

```ruby
# создание нового системного пользователя без домашнего каталога
sudo useradd -rs /bin/false service1
```


<br>

_**Задача:** Изменение настроек по умолчанию для команды useradd._

Настройки команды `useradd` разбросаны по множеству конфигурационных файлов, таких как `/etc/default/useradd`, `/etc/login.defs` и файлы в каталоге `/etc/skel`.

`/etc/login.defs` — это конфигурационный файл в операционной системе Linux, который устанавливает параметры по умолчанию для входа в систему, политик паролей и создания учётной записи пользователя. С помощью этого файла можно настроить, например, какой минимальный и максимальный id нужно выдавать, что делать с папкой пользователя при удалении, количество попыток входа и таймаут.

`/etc/default/useradd` — конфигурационный файл для команды `useradd` в системах Linux/Unix. Он определяет значения по умолчанию при создании новых учётных записей пользователей, такие как домашний каталог, оболочка и группа пользователя по умолчанию.

`/etc/skel` — каталог-шаблон в системе Linux, содержащий файлы и настройки, которые будут скопированы в домашние каталоги новых пользователей при их создании.

```ruby
sudo cat /etc/default/useradd
```
![image](https://github.com/user-attachments/assets/e0e5cadf-f70b-4f64-8511-e9adf2515670)

```ruby
sudo ls -la /etc/skel
```
![image](https://github.com/user-attachments/assets/6e9895a5-1882-4f63-b6c2-be498c2fe649)


```ruby
# Дополнительная информация
man 8 useradd
man 5 login.defs
/etc/default/useradd
/etc/skel
/etc/login/defs

# Linux книга рецептов. Карла Шрёдер, стр. 143
```



